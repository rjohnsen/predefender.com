<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.134.3">
    <meta name="generator" content="Relearn 6.4.0+tip">
    <meta name="description" content="This article explores my journey of reverse engineering a mysterious malware sample, from initial analysis to uncovering its hidden operations.">
    <meta name="author" content="Roger C.B. Johnsen">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="The Malware That Wasnt - Predefender Cyber Hunting">
    <meta name="twitter:description" content="This article explores my journey of reverse engineering a mysterious malware sample, from initial analysis to uncovering its hidden operations.">
    <meta property="og:url" content="http://localhost:1313/articles/the-malware-that-wasnt/index.html">
    <meta property="og:site_name" content="Predefender Cyber Hunting">
    <meta property="og:title" content="The Malware That Wasnt - Predefender Cyber Hunting">
    <meta property="og:description" content="This article explores my journey of reverse engineering a mysterious malware sample, from initial analysis to uncovering its hidden operations.">
    <meta property="og:locale" content="en_us">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Articles">
    <meta property="article:published_time" content="2024-12-29T10:37:22+01:00">
    <meta property="article:modified_time" content="2024-12-29T10:37:22+01:00">
    <meta property="article:tag" content="Malware">
    <meta property="article:tag" content="Analysis">
    <meta property="article:tag" content="Education">
    <meta property="article:tag" content="Reversing">
    <meta property="article:tag" content="Python">
    <meta itemprop="name" content="The Malware That Wasnt - Predefender Cyber Hunting">
    <meta itemprop="description" content="This article explores my journey of reverse engineering a mysterious malware sample, from initial analysis to uncovering its hidden operations.">
    <meta itemprop="datePublished" content="2024-12-29T10:37:22+01:00">
    <meta itemprop="dateModified" content="2024-12-29T10:37:22+01:00">
    <meta itemprop="wordCount" content="1376">
    <meta itemprop="keywords" content="Malware,Analysis,Education,Reversing,Python">
    <title>The Malware That Wasnt - Predefender Cyber Hunting</title>

    <link href="/css/fontawesome-all.min.css?1735544737" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fontawesome-all.min.css?1735544737" rel="stylesheet"></noscript>
    <link href="/css/nucleus.css?1735544737" rel="stylesheet">
    <link href="/css/auto-complete.css?1735544737" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/auto-complete.css?1735544737" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar.min.css?1735544737" rel="stylesheet">
    <link href="/css/fonts.css?1735544737" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fonts.css?1735544737" rel="stylesheet"></noscript>
    <link href="/css/theme.css?1735544737" rel="stylesheet">
    <link href="/css/theme-predefender.css?1735544737" rel="stylesheet" id="R-variant-style">
    <link href="/css/chroma-relearn-light.css?1735544737" rel="stylesheet" id="R-variant-chroma-style">
    <link href="/css/variant.css?1735544737" rel="stylesheet">
    <link href="/css/print.css?1735544737" rel="stylesheet" media="print">
    <script src="/js/variant.js?1735544737"></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.relBasePath='..\/..';
      window.relearn.relBaseUri='..\/..';
      window.relearn.absBaseUri='http:\/\/localhost:1313';
      window.relearn.disableAnchorCopy=false;
      window.relearn.disableAnchorScrolling=false;
      // variant stuff
      window.variants && variants.init( [ 'predefender' ] );
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script>
  </head>
  <body class="mobile-support html" data-url="/articles/the-malware-that-wasnt/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper"><nav class="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#methodology">Methodology</a>
      <ul>
        <li><a href="#preliminary-analysis">Preliminary Analysis</a></li>
        <li><a href="#file-analysis">File Analysis</a></li>
        <li><a href="#reverse-engineering">Reverse Engineering</a></li>
      </ul>
    </li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav>
                </div>
              </div>
            </div>
          </div>
          <span class="topbar-breadcrumbs highlightable">
            The Malware That Wasnt
          </span>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-more" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="More"><i class="fa-fw fas fa-ellipsis-v"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
                  <div class="topbar-area topbar-area-more" data-area="more">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
            <header class="headline">
<div class=" taxonomy-tags term-list cstyle  tags" title="Tags" style="--VARIABLE-TAGS-BG-color: var(--INTERNAL-TAG-BG-color);">
  <ul>
    <li><a class="term-link" href="/tags/analysis/index.html">Analysis</a></li>
    <li><a class="term-link" href="/tags/education/index.html">Education</a></li>
    <li><a class="term-link" href="/tags/malware/index.html">Malware</a></li>
    <li><a class="term-link" href="/tags/python/index.html">Python</a></li>
    <li><a class="term-link" href="/tags/reversing/index.html">Reversing</a></li>
  </ul>
</div>
            </header>

<h1 id="the-malware-that-wasnt">The Malware That Wasnt</h1>

<p>By: Roger Johnsen, 29.12.2024</p>
<p><a href="#R-image-2d852c086915c3ade3bf65d02bd185cf" class="lightbox-link"><img alt="Banner" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/articles/the-malware-that-wasnt/banner.webp" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-2d852c086915c3ade3bf65d02bd185cf"><img alt="Banner" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/articles/the-malware-that-wasnt/banner.webp"></a></p>
<h2 id="introduction">Introduction</h2>
<p><em>In this article, I’ll take you through my journey of reverse engineering a malware sample that was sent to me for investigation. The malware arrived as an executable file and, at the time, was shrouded in mystery. While it did have some detections on VirusTotal, it remained largely absent from other threat intelligence feeds I rely on, making it an interesting case to explore. Join me as I detail each step of the process, from the initial analysis to unraveling the malicious operations hidden within.</em></p>
<hr>
<h2 id="methodology">Methodology</h2>
<p>Let us first kick this off saying a word or two about methdologies. Adhering to a methodology when analyzing files is essential for maintaining consistency, efficiency, and accuracy. A structured approach minimizes the chance of missing critical details and allows analysts to work methodically, saving both time and effort. It also ensures reproducibility, enabling others to replicate the process and validate findings - a key factor in legal and investigative scenarios. Additionally, a well-defined methodology supports comprehensive analysis by covering crucial aspects such as metadata, file content, and network communications. It enhances quality control by identifying gaps, promoting thorough documentation, and fostering transparency, accountability, and compliance with regulations.</p>
<p>The following methodology is designed from a SOC analyst’s perspective to facilitate a swift initial investigation of suspicious files before escalating them to higher tiers. The process is divided into three main stages:</p>
<ul>
<li><em>Preliminary Analysis</em></li>
<li><em>File Analysis</em></li>
<li><em>Reverse Engineering</em></li>
</ul>
<p>The exact steps within each stage can vary depending on the case. For this particular scenario, the methodology was structured as follows:</p>
<pre class="mermaid align-center zoomable">
flowchart  LR
    START((Start)) --&gt; PI

    subgraph PI[&#34;Preliminary Analysis&#34;]
        A[Virustotal]
    end

    PI --&gt; FA 

    subgraph FA[&#34;File Analysis&#34;]
        B[Record Evidence Information]
        C[Identity Binary]
        D[Detect Human Readable Strings]

        B--&gt;C--&gt;D
    end

    FA--&gt;RE

    subgraph RE[&#34;Reverse Engineering&#34;]
        E[pyinstxtractor]
        F[PyLingual]

        E --&gt; F
    end

    RE--&gt;STOP((Stop))
</pre>
<p>The investigation was carried out using my analysis platform of choice, Fedora Linux with custom selected tool chain.</p>
<h3 id="preliminary-analysis">Preliminary Analysis</h3>
<p>When I received this malware sample, I first uploaded it to VirusTotal to check if it was already known. However, in some cases, depending on the nature of the sample and the specific circumstances, I would make a carefully considered decision not to upload it immediately. In this particular instance, I  chose to upload the sample to VirusTotal right away, as there were no immediate, severe or any active threats ongoing.</p>
<p><a href="#R-image-6b534b4810ae089b252e30ccbf65226c" class="lightbox-link"><img alt="VirusTotal detection" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/articles/the-malware-that-wasnt/virustotal-detection-1.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-6b534b4810ae089b252e30ccbf65226c"><img alt="VirusTotal detection" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/articles/the-malware-that-wasnt/virustotal-detection-1.png"></a></p>
<p>Seven out of seventity two engines had something to say about the malware sample, which was remarkably few. For clarity, I have included the engine results below.</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left"><strong>Vendor</strong></th>
          <th style="text-align: left"><strong>Detection</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Avast</td>
          <td style="text-align: left">Win64:Malware-gen</td>
      </tr>
      <tr>
          <td style="text-align: left">AVG</td>
          <td style="text-align: left">Win64:Malware-gen</td>
      </tr>
      <tr>
          <td style="text-align: left">Malwarebytes</td>
          <td style="text-align: left">Malware.AI.4283851620</td>
      </tr>
      <tr>
          <td style="text-align: left">SecureAge</td>
          <td style="text-align: left">Malicious</td>
      </tr>
      <tr>
          <td style="text-align: left">SentinelOne (Static ML)</td>
          <td style="text-align: left">Static AI - Suspicious PE</td>
      </tr>
      <tr>
          <td style="text-align: left">Skyhigh (SWG)</td>
          <td style="text-align: left">BehavesLike.Win64.PUPXEO.vc</td>
      </tr>
      <tr>
          <td style="text-align: left">Zillya</td>
          <td style="text-align: left">Trojan.Agent.Win32.4064176</td>
      </tr>
  </tbody>
</table>
<p>Much can be said about the engines on VirusTotal. For example, several of them use the same underlying detection engine. Avast and AVG, for instance, share the same detection technology, as both are owned by Gen Digital Inc. (formerly Avast Software and NortonLifeLock). Their antivirus products leverage the same core technologies, often resulting in identical or very similar detections, such as &ldquo;Win64:Malware-gen.&rdquo;</p>
<p>However, when examining which engines flagged the sample, I found it odd that major players like Microsoft, Fortinet, Palo Alto Networks, Trend Micro, Sophos, and Symantec had nothing to report. In my view, when industry leaders of this caliber - who I consider forerunners - fail to detect anything, yet lesser-known engines flag the sample, it strongly suggests that the detection is likely a false positive. I though I&rsquo;d better move into file analysis stage.</p>
<h3 id="file-analysis">File Analysis</h3>
<h4 id="recording-evidence-information">Recording Evidence Information</h4>
<p>Calculating file hashes is essential in malware investigations as it verifies file integrity, uniquely identifies files, and enables quick classification by comparing against threat databases like VirusTotal. Hashes help detect duplicates, share threat intelligence, provide historical context, and automate analysis workflows. They also serve as evidence in forensic investigations, ensuring file authenticity and maintaining a chain of custody.</p>
<p>In my case I use hashes to verify that I am working on the correct version of the sample, and to refer to a particular file in the report. To start, I calculated cryptographic hashes of the suspicious sample for reference:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>md5sum main.exe
</span></span><span style="display:flex;"><span>c6c144b3278373a9a7cecdae34ec6a44  main.exe
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sha256sum main.exe
</span></span><span style="display:flex;"><span>49f908c69750b369ea54fc48ed85be624574599815e82669bd95d2bfe5e611f7  main.exe</span></span></code></pre></div>
<h4 id="identify-binary">Identify Binary</h4>
<p>The <code>file</code> command is used to quickly determine key details about the sample, such as its file type (PE32+ executable), architecture (64-bit), application type (console), platform (Windows), and structure (6 sections). This initial information helps guide further analysis by confirming the file’s format and preparing the right tools and environment for deeper investigation.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>file main.exe
</span></span><span style="display:flex;"><span>main.exe: PE32+ executable <span style="color:#f92672">(</span>console<span style="color:#f92672">)</span> x86-64, <span style="color:#66d9ef">for</span> MS Windows, <span style="color:#ae81ff">6</span> sections</span></span></code></pre></div>
<h4 id="detect-human-readable-strings">Detect Human Readable Strings</h4>
<p>Running <code>strings -n10 main.exe</code> extracts human-readable strings from the malware, revealing potential indicators of compromise (IOCs), hardcoded information, error messages, and clues about its behavior. This helps us quickly identify malicious activity, hidden details, and communication patterns, aiding in faster investigation and analysis.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>strings -n10 main.exe</span></span></code></pre></div>
<p>Sample output (end excerpt) from my malware sample:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>... SNIP ...
bbase_library.zip
blibcrypto-3.dll
bpython313.dll
bselect.pyd
bucrtbase.dll
bunicodedata.pyd
opyi-contents-directory _internal
zPYZ-00.pyz
9python313.dll</code></pre></div>
<p>At the very end of the output from the above command there were some references to Python:</p>
<ul>
<li><code>bpython313.dll</code></li>
<li><code>9python313.dll</code></li>
</ul>
<p>The appearance of <strong><code>bpython313.dll</code></strong> and <strong><code>9python313.dll</code></strong> strongly suggested this was a Python-based application. To dig deeper, we search for further Python-related references:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>strings -n10 main.exe | grep -i python</span></span></code></pre></div>
<p>Nothing much of interest revealed, except for some minor artefacts:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pyi-python-flag
</span></span><span style="display:flex;"><span>Reported length <span style="color:#f92672">(</span>%d<span style="color:#f92672">)</span> of Python shared library name <span style="color:#f92672">(</span>%s<span style="color:#f92672">)</span> exceeds buffer size <span style="color:#f92672">(</span>%d<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Path of Python shared library <span style="color:#f92672">(</span>%s<span style="color:#f92672">)</span> and its name <span style="color:#f92672">(</span>%s<span style="color:#f92672">)</span> exceed buffer size <span style="color:#f92672">(</span>%d<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Failed to pre-initialize embedded python interpreter!
</span></span><span style="display:flex;"><span>Failed to allocate PyConfig structure! Unsupported python version?
</span></span><span style="display:flex;"><span>Failed to set python home path!
</span></span><span style="display:flex;"><span>Failed to start embedded python interpreter!
</span></span><span style="display:flex;"><span>9python313.dll</span></span></code></pre></div>
<p>It is still apparent that this is a Python application packed as a binary. Most likely it was either packed using <code>PyInstaller</code> or <code>Py2Exe</code>. But which? Let&rsquo;s find out by searching for more Python references!</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>strings -n10 main.exe | grep -i py</span></span></code></pre></div>
<p>And yes - there were more Python references:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>PYI-%d:%s<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>PYI-%d:ERROR<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Absolute path to script exceeds PYI_PATH_MAX
</span></span><span style="display:flex;"><span>_pyi_main_co
</span></span><span style="display:flex;"><span>PYINSTALLER_RESET_ENVIRONMENT
</span></span><span style="display:flex;"><span>_PYI_ARCHIVE_FILE
</span></span><span style="display:flex;"><span>_PYI_APPLICATION_HOME_DIR
</span></span><span style="display:flex;"><span>_PYI_PARENT_PROCESS_LEVEL
</span></span><span style="display:flex;"><span>_PYI_SPLASH_IPC
</span></span><span style="display:flex;"><span>Invalid value in _PYI_PARENT_PROCESS_LEVEL: %s
</span></span><span style="display:flex;"><span>PYINSTALLER_STRICT_UNPACK_MODE
</span></span><span style="display:flex;"><span>... SNIP ...</span></span></code></pre></div>
<p>Based on these indicators, I confidently concluded the binary was packed using <strong><a href="https://pyinstaller.org/en/stable/" rel="external" target="_blank">PyInstaller</a>
</strong>.</p>
<h3 id="reverse-engineering">Reverse Engineering</h3>
<p>Knowing both tools from past reverse engineering sessions, I went on trying to reverse engineer the sample. For this I used the following tools:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left"><strong>Tool</strong></th>
          <th style="text-align: left"><strong>Description</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><a href="https://github.com/extremecoders-re/pyinstxtractor" rel="external" target="_blank">PyInstaller Extractor</a>
</td>
          <td style="text-align: left">Extracts contents from PyInstaller-packaged executables.</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="https://pylingual.io" rel="external" target="_blank">PyLingual</a>
</td>
          <td style="text-align: left">A Python decompilation service for restoring bytecode to source code with semantic verification.</td>
      </tr>
  </tbody>
</table>
<h4 id="reversing-process">Reversing process</h4>
<p>First, had to I extract the compiled Python files (<code>.pyc</code> and <code>.pyz</code>) from the binary using the tool <code>pyinstxtractor</code> - like so:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>python3 ../Tools/pyinstxtractor/pyinstxtractor.py main.exe</code></pre></div>
<p>Artefacts were extracted into a folder called <code>main.exe_extracted</code>:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>main.pyc
pyiboot01_bootstrap.pyc
pyimod01_archive.pyc
pyimod02_importers.pyc
pyimod03_ctypes.pyc
pyimod04_pywin32.pyc
pyi_rth_inspect.pyc
PYZ-00.pyz
PYZ-00.pyz_extracted
struct.pyc</code></pre></div>
<p>There were several <code>.pyc</code> files available, but the one that caught my eye were <code>main.py</code>. Whenever I see a <code>main</code> named file it basically means the entry point for the file (or anything else resembling an entrypoint). In order to decompile it I uploaded it to <a href="https://pylingual.io" rel="external" target="_blank">PyLingual</a>
:</p>
<p><a href="#R-image-56ba16ec239b8afe14d5be3c1262e332" class="lightbox-link"><img alt="PyLingual Upload page" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/articles/the-malware-that-wasnt/pylingual-1.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-56ba16ec239b8afe14d5be3c1262e332"><img alt="PyLingual Upload page" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/articles/the-malware-that-wasnt/pylingual-1.png"></a></p>
<p>After processing, the decompiled source code was revealed:</p>
<p><a href="#R-image-a6ef641589c39b40042ef4b3864d9931" class="lightbox-link"><img alt="PyLingual decompiled code" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/articles/the-malware-that-wasnt/pylingual-2.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-a6ef641589c39b40042ef4b3864d9931"><img alt="PyLingual decompiled code" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/articles/the-malware-that-wasnt/pylingual-2.png"></a></p>
<p>Here’s the resulting code:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Decompiled with PyLingual (https://pylingual.io)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Internal filename: main.py</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Bytecode version: 3.13.0rc3 (3571)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Source timestamp: 1970-01-01 00:00:00 UTC (0)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> pprint <span style="color:#f92672">import</span> pprint
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Software</span>:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">run</span>(self):
</span></span><span style="display:flex;"><span>        res <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;https://api.ipify.org?format=json&#39;</span>)
</span></span><span style="display:flex;"><span>        pprint(res<span style="color:#f92672">.</span>json())
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;This is the Malware that wasn&#39;t! ;)&#34;</span>)
</span></span><span style="display:flex;"><span>    Software <span style="color:#f92672">=</span> Software()
</span></span><span style="display:flex;"><span>    Software<span style="color:#f92672">.</span>run()</span></span></code></pre></div>
<p>The other Pyc&rsquo;s did not contain anything relevant and I skipped these.</p>
<h2 id="conclusion">Conclusion</h2>
<p>The analysis concluded here. This so-called &ldquo;malware&rdquo; lacked traditional characteristics commonly associated with malicious software, such as complex library calls, process carving, or code injection techniques. The original sample was somewhat more complex, but I had to simplify it for this article. Despite detections on VirusTotal, the analysis revealed that the binary was not malicious, highlighting that we cannot fully trust VirusTotal’s verdicts, though it can guide us. This case emphasizes the importance of thorough investigation beyond tool detections and reinforces the value of context and a structured methodology in cybersecurity analysis. It&rsquo;s also important to note that VirusTotal flagged PyInstaller artefacts, not the underlying code itself - and that is something we should carry with us in future investigations.</p>
<hr>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Revised Date</th>
          <th style="text-align: left">Author</th>
          <th style="text-align: left">Comment</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">29.12.2024</td>
          <td style="text-align: left">Roger Johnsen</td>
          <td style="text-align: left">Article added</td>
      </tr>
  </tbody>
</table>

            <footer class="footline">
            </footer>
          </article>
        </div>
      </main>
    </div>
    <aside id="R-sidebar" class="default-animation">
      <div id="R-header-topbar" class="default-animation"></div>
      <div id="R-header-wrapper" class="default-animation">
        <div id="R-header" class="default-animation">
<a href="https://predefender.com/">
    <img src="/images/predefender-logo.png" />
</a>
        </div>
      </div>
      <div id="R-homelinks" class="default-animation">
        <hr class="padding">
      </div>
      <div id="R-content-wrapper" class="highlightable">
        <div id="R-topics">
          <ul class="enlarge morespace collapsible-menu">
          <li data-nav-id="/articles/index.html" class="parent "><a class="padding" href="/articles/index.html">Articles</a><ul id="R-subsections-9cdb117f2ad8cea068f2f14b54e72bff" class="morespace collapsible-menu">
          <li data-nav-id="/articles/the-malware-that-wasnt/index.html" class="active"><a class="padding" href="/articles/the-malware-that-wasnt/index.html">The Malware That Wasnt</a></li></ul></li>
          <li data-nav-id="/projects/index.html" class=""><a class="padding" href="/projects/index.html">Projects</a></li>
          <li data-nav-id="/resources/index.html" class=""><a class="padding" href="/resources/index.html">Resources</a></li>
          <li data-nav-id="/about/index.html" class=""><a class="padding" href="/about/index.html">About</a></li>
          <li data-nav-id="/contact/index.html" class=""><a class="padding" href="/contact/index.html">Contact</a></li>
          </ul>
        </div>
        <div class="padding footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showFooter"></div>
        <div id="R-menu-footer">
          <hr class="padding default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showFooter">
          <div id="R-prefooter" class="footerLangSwitch footerVariantSwitch footerVisitedLinks">
            <ul>
              <li id="R-select-language-container" class="footerLangSwitch">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-language"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <label class="a11y-only" for="R-select-language">Language</label>
                    <select id="R-select-language" onchange="location = this.querySelector( this.value ).dataset.url;">
                      <option id="R-select-language-en" value="#R-select-language-en" data-url="/articles/the-malware-that-wasnt/index.html" lang="en-us" selected></option>
                    </select>
                  </div>
                  <div class="clear"></div>
                </div>
              </li>
              <li id="R-select-variant-container" class="footerVariantSwitch">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-paint-brush"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <label class="a11y-only" for="R-select-variant">Theme</label>
                    <select id="R-select-variant" onchange="window.variants && variants.changeVariant( this.value );">
                      <option id="R-select-variant-predefender" value="predefender" selected>Predefender</option>
                    </select>
                  </div>
                  <div class="clear"></div>
                </div>
                <script>window.variants && variants.markSelectedVariant();</script>
              </li>
              <li class="footerVisitedLinks">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-history"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <button onclick="clearHistory();">Clear History</button>
                  </div>
                  <div class="clear"></div>
                </div>
              </li>
            </ul>
          </div>
          <div id="R-footer" class="footerFooter showFooter"><p>Copyright Roger Johnsen</p>
<p>All rights reserved.</p>
<script src="https://cdn.counter.dev/script.js" data-id="f2222025-310f-4c96-9abb-aee09ff8d01f" data-utcoffset="2"></script>
          </div>
        </div>
      </div>
    </aside>
    <script src="/js/clipboard.min.js?1735544737" defer></script>
    <script src="/js/perfect-scrollbar.min.js?1735544737" defer></script>
    <script src="/js/d3/d3-color.min.js?1735544737" defer></script>
    <script src="/js/d3/d3-dispatch.min.js?1735544737" defer></script>
    <script src="/js/d3/d3-drag.min.js?1735544737" defer></script>
    <script src="/js/d3/d3-ease.min.js?1735544737" defer></script>
    <script src="/js/d3/d3-interpolate.min.js?1735544737" defer></script>
    <script src="/js/d3/d3-selection.min.js?1735544737" defer></script>
    <script src="/js/d3/d3-timer.min.js?1735544737" defer></script>
    <script src="/js/d3/d3-transition.min.js?1735544737" defer></script>
    <script src="/js/d3/d3-zoom.min.js?1735544737" defer></script>
    <script src="/js/js-yaml.min.js?1735544737" defer></script>
    <script src="/js/mermaid.min.js?1735544737" defer></script>
    <script>
      window.themeUseMermaid = JSON.parse("{}");
    </script>
    <script src="/js/theme.js?1735544737" defer></script>
    <script src="https://cdn.counter.dev/script.js" data-id="f2222025-310f-4c96-9abb-aee09ff8d01f" data-utcoffset="2"></script>
  </body>
</html>
